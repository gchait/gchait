FROM python:3.12-alpine

ENV PORT 1234
ENV WORKERS 1234
ENV THREADS 1234
ENV PYTHONDONTWRITEBYTECODE 1
ENV PYTHONUNBUFFERED 1
ENV PIP_DISABLE_PIP_VERSION_CHECK 1
ENV APP_DIR /appdir
ENV APP_USER appuser

RUN adduser -DHs /sbin/nologin -g ${APP_USER} ${APP_USER}
WORKDIR ${APP_DIR}

COPY . .
RUN pip install --no-cache-dir -r requirements.txt

USER ${APP_USER}
EXPOSE ${PORT}

CMD ["./run.sh"]
